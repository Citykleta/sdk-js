{"version":3,"file":"citykleta.es.js","sources":["../src/sdk.js"],"sourcesContent":["export var HTTPMethod;\n(function (HTTPMethod) {\n    HTTPMethod[\"PUT\"] = \"PUT\";\n    HTTPMethod[\"POST\"] = \"POST\";\n    HTTPMethod[\"GET\"] = \"GET\";\n    HTTPMethod[\"DELETE\"] = \"DELETE\";\n})(HTTPMethod || (HTTPMethod = {}));\nconst parseResponse = async (response) => {\n    if (response.ok === false) {\n        throw {\n            status: response.status,\n            message: await response.json()\n        };\n    }\n    return response.json();\n};\nconst defaultUrl = 'https://api.citykleta.com';\nexport const sdk = (fetch, URL, btoa) => ({ url = defaultUrl } = { url: 'https://api.citykleta.com' }) => {\n    const baseUrl = () => new URL(url);\n    const withUrl = (mixin) => Object.defineProperties(mixin, {\n        url: {\n            get() {\n                return baseUrl().href;\n            }\n        }\n    });\n    const defaultHeaders = opts => {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n        if (opts.token) {\n            headers.Authorization = `Bearer ${opts.token}`;\n        }\n        else if (opts.secret && opts.clientId) {\n            headers.Authorization = `Basic ` + btoa(`${opts.clientId}:${opts.secret}`);\n        }\n        return headers;\n    };\n    const listable = (path) => (opts = {}) => {\n        const headers = defaultHeaders(opts);\n        const baseUrl = new URL(url);\n        return withUrl({\n            async list({ page = 1, size = 15 } = { page: 1, size: 15 }) {\n                const url = new URL(path, baseUrl);\n                url.searchParams.append('page', page);\n                url.searchParams.append('size', size);\n                const response = await fetch(url.href, {\n                    headers\n                });\n                return parseResponse(response);\n            },\n            async one(id) {\n                const url = new URL(`${path}/${id}`, baseUrl);\n                const response = await fetch(url.href, {\n                    headers\n                });\n                return parseResponse(response);\n            }\n        });\n    };\n    return {\n        Users: listable('/users'),\n        Bikes: listable('/bikes'),\n        Businesses: listable('/businesses'),\n        Tokens(opts = {}) {\n            const headers = defaultHeaders(opts);\n            return withUrl({\n                async create({ username, password }) {\n                    const url = baseUrl();\n                    url.pathname = `/tokens`;\n                    const response = await fetch(url.href, {\n                        method: \"POST\" /* POST */,\n                        headers,\n                        body: JSON.stringify({\n                            grant_type: 'password',\n                            username,\n                            password\n                        })\n                    });\n                    return parseResponse(response);\n                }\n            });\n        }\n    };\n};\n"],"names":[],"mappings":"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"}