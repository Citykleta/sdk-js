{"version":3,"file":"citykleta.js","sources":["../src/sdk.js"],"sourcesContent":["export var HTTPMethod;\n(function (HTTPMethod) {\n    HTTPMethod[\"PUT\"] = \"PUT\";\n    HTTPMethod[\"POST\"] = \"POST\";\n    HTTPMethod[\"GET\"] = \"GET\";\n    HTTPMethod[\"DELETE\"] = \"DELETE\";\n})(HTTPMethod || (HTTPMethod = {}));\nconst parseResponse = async (response) => {\n    if (response.ok === false) {\n        throw {\n            status: response.status,\n            message: await response.json()\n        };\n    }\n    return response.json();\n};\nconst defaultUrl = 'https://api.citykleta.com';\nexport const sdk = (fetch, URL, btoa) => ({ url = defaultUrl } = { url: 'https://api.citykleta.com' }) => {\n    const baseUrl = () => new URL(url);\n    const withUrl = (mixin) => Object.defineProperties(mixin, {\n        url: {\n            get() {\n                return baseUrl().href;\n            }\n        }\n    });\n    const defaultHeaders = opts => {\n        const headers = {\n            'Content-Type': 'application/json'\n        };\n        if (opts.token) {\n            headers.Authorization = `Bearer ${opts.token}`;\n        }\n        else if (opts.secret && opts.clientId) {\n            headers.Authorization = `Basic ` + btoa(`${opts.clientId}:${opts.secret}`);\n        }\n        return headers;\n    };\n    const listable = (path) => (opts = {}) => {\n        const headers = defaultHeaders(opts);\n        const baseUrl = new URL(url);\n        return withUrl({\n            async list({ page = 1, size = 15 } = { page: 1, size: 15 }) {\n                const url = new URL(path, baseUrl);\n                url.searchParams.append('page', page);\n                url.searchParams.append('size', size);\n                const response = await fetch(url.href, {\n                    headers\n                });\n                return parseResponse(response);\n            },\n            async one(id) {\n                const url = new URL(`${path}/${id}`, baseUrl);\n                const response = await fetch(url.href, {\n                    headers\n                });\n                return parseResponse(response);\n            }\n        });\n    };\n    return {\n        Users: listable('/users'),\n        Bikes: listable('/bikes'),\n        Businesses: listable('/businesses'),\n        Tokens(opts = {}) {\n            const headers = defaultHeaders(opts);\n            return withUrl({\n                async create({ username, password }) {\n                    const url = baseUrl();\n                    url.pathname = `/tokens`;\n                    const response = await fetch(url.href, {\n                        method: \"POST\" /* POST */,\n                        headers,\n                        body: JSON.stringify({\n                            grant_type: 'password',\n                            username,\n                            password\n                        })\n                    });\n                    return parseResponse(response);\n                }\n            });\n        }\n    };\n};\n"],"names":["HTTPMethod"],"mappings":"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"}